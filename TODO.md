# Romanesco プログラミング言語 開発ロードマップ

Romanesco は、Z3 ソルバーによる制約解決と、衛生的なマクロシステムを核とした「真に汎用な」型無し言語です。
特定の目的に縛られず、あらゆる言語の機能をプラグインとして取り込み、安全に実行・検証することを目指します。

---

## 🎯 設計思想（こだわり）
- **真の汎用性**: あらゆる表現ができ、あらゆる状況でトップパフォーマンスを発揮する。
- **ゼロ・シンタックス**: 必要な機能だけを `init` から選択し、目的に特化した言語をその場で構築する。
- **制約による安全**: 型システムの代わりに Z3 ソルバーを用い、実行前に論理的な正当性を証明する。
- **言語の垣根の撤廃**: 既存・未来のあらゆる言語の機能を平等に扱える救済手段となる。

---

## ✅ 達成済み
- [x] **並行格子レキサー**: すべての解釈の可能性を網羅する高速な並行スキャン。
- [x] **非決定論的 Packrat パーサー**: 格子状データ（Lattice）を最長一致でバックトラックしながら解析する基盤。
- [x] **明示的空白ハンドリング**: `_S` による透明性の高い構文定義。
- [x] **モジュール化された `init`**: 機能（DNA）を選択的に注入できる言語構成。
- [x] **Z3 ソルバー連携（基本）**: `X = 10` のような単一化制約の解決と推論。

---

## 🚀 Phase 1: 意味論と制約エンジンの強化 (Semantics & Solver)
パースされた AST をより高度な論理に結びつけ、「型システムとしてのソルバー」を確立する。
- [ ] **算術・比較演算の追加**: `+`, `-`, `*`, `>`, `<` などの制約を Z3 に流し込む。
- [ ] **条件付き制約 (Guards)**: `if X > 0 then ...` のように、ソルバーの解の状態によって実行を分岐させる。
- [ ] **リファインメント・タイプの実装**: `init` 内で「この変数は偶数である」といった制約を「型」として定義するモジュール。
- [ ] **エラーレポートの高度化**: `UNSAT`（矛盾）発生時、どのソースコードの行が原因かを表示する。

## 🛠️ Phase 2: ハイジェニック・マクロシステム (Self-Modification)
言語が自己を再定義し、新しい構文を生成する能力を実装する。
- [ ] **パース結果の再編集**: `result`（ASTの配列）を操作してコードを書き換える組み込み関数。
- [ ] **構文定義構文**: ソースコード内で `syntax "..." = ...` と書くことでパーサーにルールを追加する機能。
- [ ] **衛生的識別子の完全利用**: マクロ展開時の名前衝突を `HygenicTag` と Z3 スコープ制約で解決する。

## 🌍 Phase 3: 汎用性とポータビリティ (Portability & Performance)
あらゆるプラットフォームへの適応。
- [ ] **ターゲット・トランスパイラ**: AST を C, JavaScript, WASM などへ「蒸留」して出力する機能。
- [ ] **ネイティブコード生成**: LLVM 等を介した直接的な機械語出力。
- [ ] **標準ライブラリカタログ**: `init` から呼び出せる多様な言語パラダイム（Lisp風、C風、Prolog風）の整備。

---

## 📝 直近の作業メモ
1. 算術演算子 (`+`, `-`) のパーサーとソルバー対応。
2. `X + Y = 20` などのパズル的制約の解決デモ。
3. `X : Int` のような型宣言を制約として扱う実験。
